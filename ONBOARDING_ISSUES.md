# Onboarding Issues Identified

This document outlines the key friction points and issues identified during a simulated first-run experience of the `vm` CLI, from the perspective of a new user.

## 1. Lack of a "First Run" User Guide

The `CLAUDE.md` developer guide is comprehensive for contributors but lacks a clear, concise "Getting Started" or "First Run" section for new users who simply want to use the `vm` tool. The existing documentation is heavily focused on the development and testing of the tool itself.

**Recommendation:** Add a user-centric "Quick Start" section to the main `README.md` or a new `GUIDE.md` that walks through the `vm init`, `vm create`, `vm status`, and `vm destroy` workflow.

## 2. Docker Permission Errors

The `vm create` command fails with a Docker permission error if the user is not correctly configured to run Docker commands without `sudo`.

- The error message provides a suggested fix: `sudo usermod -aG docker $USER && newgrp docker`.
- In non-interactive environments (like the one used for this review), this command is not always effective because the new group membership doesn't take effect until a new shell session is started.
- This required a less-secure workaround (`sudo chmod 666 /var/run/docker.sock`) to proceed.

**Recommendation:**
- Enhance `vm doctor` to check for Docker permissions and provide a more robust set of instructions, explaining that a new shell session or logout/login might be required.
- Consider having `vm init` perform this check as well to proactively warn users.

## 3. `vm create` Failure with Default Configuration

The `vm create` command fails when using the default `vm.yaml` generated by `vm init`. The failure occurs during the Ansible provisioning stage.

- The verbose output shows the `useradd` command failing with the error: `useradd: invalid user name ''`.
- This is because the `project_user` variable, which is used to create a user in the VM, is not set in the default `vm.yaml`. The Ansible script does not handle this empty variable gracefully.

**Recommendation:**
- Modify the `vm init` command to include a default `project_user` in the generated `vm.yaml`. A sensible default would be the current `$USER`.
- Add validation to the `vm create` command to ensure that `project_user` is not empty before starting the provisioning process.

## 4. Misleading Timeout on `vm create` Failure

When the Ansible provisioning fails, the `vm create` command hangs for a long time (over 6 minutes in testing) before timing out. The initial timeout message does not provide any clue as to the root cause. The underlying Ansible error is only visible when the `--verbose` flag is used.

**Recommendation:**
- Improve the error handling and output streaming for the Ansible provisioning process. The error from the underlying Ansible command should be surfaced to the user immediately, rather than waiting for a timeout.
